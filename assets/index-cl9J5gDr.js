(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();const oe=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),He=(e,t)=>{e.x*=t,e.y*=t},X=e=>({x:Math.cos(e),y:Math.sin(e)}),ne=e=>Math.sqrt(e.x**2+e.y**2);let E=new Map;const Ne=2e3,O=e=>{const t={x:e.position.x,y:e.position.y,rotation:e.rotation},o=e.parent;if(o==null)return t;const a=O(o),s=Math.cos(a.rotation),r=Math.sin(a.rotation);return{x:a.x+t.x*s-t.y*r,y:a.y+t.x*r+t.y*s,rotation:a.rotation+t.rotation}},We=(e,t)=>{E[e]||(E[e]=[]);const o=performance.now();E[e].push({x:t.x,y:t.y,time:o}),E[e]=E[e].filter(a=>o-a.time<Ne)},qe=e=>{delete E[e]},$e=e=>{for(const t in E){const o=E[t];if(!(!o||o.length<2)){e.beginPath();for(let a=0;a<o.length;a++){const s=o[a];a===0?e.moveTo(s.x,s.y):e.lineTo(s.x,s.y)}e.strokeStyle="rgba(255, 255, 255, 0.5)",e.lineWidth=1,e.stroke()}}},je="/asteroid-pew-pew/img/rock.webp",Ge="/asteroid-pew-pew/img/boom/boom_0.gif",ze="/asteroid-pew-pew/img/boom/boom_1.gif",Ke="/asteroid-pew-pew/img/boom/boom_2.gif",Ye="/asteroid-pew-pew/img/boom/boom_3.gif",Xe="/asteroid-pew-pew/img/boom/boom_4.gif",Je="/asteroid-pew-pew/img/boom/boom_5.gif",Qe="/asteroid-pew-pew/img/boom/boom_6.gif",Ze="/asteroid-pew-pew/img/boom/boom_7.gif",et="/asteroid-pew-pew/img/boom/boom_8.gif",tt="/asteroid-pew-pew/img/boom/boom_9.gif",ot="/asteroid-pew-pew/img/boom/boom_10.gif",st="/asteroid-pew-pew/img/boom/boom_11.gif",at="/asteroid-pew-pew/img/boom/boom_12.gif",rt="/asteroid-pew-pew/img/boom/boom_13.gif",it="/asteroid-pew-pew/img/boom/boom_14.gif",S=document.getElementsByTagName("canvas")[0],i=S.getContext("2d"),C="asteroid",w="bullet",H="explosion",j="flash",v="rocket",N="spaceship",ve="velocity",V="spaceshippart",R="flames",nt="#ffffff",ct="#ffff00",q="#ff0000",ce="#00ff00";let lt=0;const dt=()=>`${lt++}`,b={[C]:{color:nt},[w]:{color:ct,length:10,strokeWidth:2},[v]:{color:q,radius:10},[N]:{color:ce},[ve]:{color:q},[V]:{color:ce},[R]:{color:q}},P={[R]:{},[N]:{},[V]:{},[C]:{},[w]:{},[v]:{},[H]:{},[j]:{}};let be=!1,z=!1,Me=!1,Te=!1;const mt=e=>{be=e},ht=e=>{z=e},gt=e=>{Me=e},ut=e=>{Te=e},T=(e,t)=>{t.id=dt(),P[e][t.id]=t},M=(e,t)=>{delete P[e][t],qe(t)},pt=()=>{for(const e in P)P[e]={}},ft=new Image;ft.src=je;const g=[];for(let e=0;e<15;++e)g.push(new Image);g[0].src=Ge;g[1].src=ze;g[2].src=Ke;g[3].src=Ye;g[4].src=Xe;g[5].src=Je;g[6].src=Qe;g[7].src=Ze;g[8].src=et;g[9].src=tt;g[10].src=ot;g[11].src=st;g[12].src=at;g[13].src=rt;g[14].src=it;const yt=()=>{S.width=S.clientWidth,S.height=S.clientHeight,i.clearRect(0,0,S.width,S.height);for(const e in P)for(const t of Object.values(P[e])){switch(e){case C:xt(t);break;case H:bt(t);break;case w:wt(t);break;case v:vt(t);break;case N:case V:Mt(t);break;case R:Tt(t);break;case j:kt(t);break}We(t.id,O(t))}if(be){i.strokeStyle=b[ve].color,i.lineWidth=1,i.beginPath();for(const e in P){for(const t of Object.values(P[e]))if("velocity"in t){const{position:o,velocity:a}=t,{x:s,y:r}=o,{x:c,y:l}=a;i.moveTo(s,r),i.lineTo(s+c*200,r+l*200)}i.stroke()}}Me&&$e(i)},xt=e=>{const{radius:t,texture:o}=e,a=O(e);i.save(),i.translate(a.x,a.y),i.rotate(a.rotation),i.drawImage(o,-t,-t,t*2,t*2),z&&(i.strokeStyle=q,i.lineWidth=1,i.beginPath(),i.moveTo(0,0),i.arc(0,0,t,0,2*Math.PI),i.stroke()),i.restore()},wt=e=>{var s;const{length:t}=b[w],o=Math.cos(e.rotation)*t/2,a=Math.sin(e.rotation)*t/2;i.fillStyle=b[w].color,i.strokeStyle=b[w].color,i.lineWidth=(s=b[w])==null?void 0:s.strokeWidth,i.beginPath(),i.moveTo(e.position.x+o,e.position.y+a),i.lineTo(e.position.x-o,e.position.y-a),i.stroke()},vt=e=>{var c;const{radius:t}=b[v],o=2*Math.PI/8,a={x:e.position.x+t*Math.cos(e.rotation),y:e.position.y+t*Math.sin(e.rotation)},s={x:e.position.x-t*Math.cos(e.rotation+o),y:e.position.y-t*Math.sin(e.rotation+o)},r={x:e.position.x-t*Math.cos(e.rotation-o),y:e.position.y-t*Math.sin(e.rotation-o)};if(i.fillStyle=b[v].color,i.strokeStyle=b[v].color,i.lineWidth=((c=b[v])==null?void 0:c.strokeWidth)??0,i.beginPath(),i.moveTo(a.x,a.y),i.lineTo(s.x,s.y),i.lineTo(r.x,r.y),i.lineTo(a.x,a.y),i.stroke(),Te){i.strokeStyle="grey",i.beginPath(),i.moveTo(e.pathPoints[0].x,e.pathPoints[0].y);for(const l of e.pathPoints)i.lineTo(l.x,l.y),i.arc(l.x,l.y,2,0,2*Math.PI),i.moveTo(l.x,l.y);i.lineTo(e.targets[e.targets.length-1].x,e.targets[e.targets.length-1].y),i.stroke()}},bt=e=>{i.translate(e.position.x,e.position.y);const a=g[e.frame];i.drawImage(a,-100/2,-100/2,100,100),i.translate(-e.position.x,-e.position.y),e.frame<g.length-1?e.frame++:M(H,e.id)},Mt=e=>{const{width:t,height:o,texture:a}=e,s=O(e);i.save(),i.translate(s.x,s.y),i.rotate(s.rotation),i.drawImage(a,-t/2,-o/2,t,o),z&&(i.strokeStyle="lime",i.lineWidth=1,i.strokeRect(-t/2,-o/2,t,o)),i.restore()},Tt=e=>{var I,Y,_;const{width:t,height:o}=e,a=O(e),s=((I=e==null?void 0:e.parent)==null?void 0:I.velocity)??{x:0,y:1},r=((_=(Y=e==null?void 0:e.parent)==null?void 0:Y.parent)==null?void 0:_.velocity)??{x:0,y:0},c={x:s.x+r.x,y:s.y+r.y},l=Math.min(Math.sqrt(c.x**2+c.y**2)*5,2);i.save(),i.translate(a.x,a.y),i.rotate(a.rotation),i.beginPath();const m=Math.random()*5;i.moveTo(0,0),i.lineTo(-t,(o+m)*l),i.lineTo(t,(o+m)*l),i.closePath(),i.fillStyle="orange",i.fill(),i.beginPath(),i.moveTo(0,0),i.lineTo(-t/2,(o/2+m)*l),i.lineTo(t/2,(o/2+m)*l),i.closePath(),i.fillStyle="yellow",i.fill(),z&&(i.strokeStyle="lime",i.lineWidth=1,i.strokeRect(-t,0,t*2,o+m)),i.restore()},kt=e=>{const t=e.position,o=3,a=15;i.fillStyle="white",i.beginPath(),i.moveTo(t.x+o,t.y+o),i.lineTo(t.x+a,t.y),i.lineTo(t.x+o,t.y-o),i.lineTo(t.x,t.y-a),i.lineTo(t.x-o,t.y-o),i.lineTo(t.x-a,t.y),i.lineTo(t.x-o,t.y+o),i.lineTo(t.x,t.y+a),i.closePath(),i.fill()},U=()=>({position:{x:0,y:0},velocity:{x:0,y:0},acceleration:{x:0,y:0},force:{x:0,y:0},rotation:0,angularVelocity:0,angularAcceleration:0,torque:0,mass:1,inertia:1,radius:0,drag:1,height:0,width:0,maxVelocity:1,parent:null,texture:null}),J=(e,t)=>{if(e.frozen)return;e.position.x+=e.velocity.x*t+.5*e.acceleration.x*t**2,e.position.y+=e.velocity.y*t+.5*e.acceleration.y*t**2,e.rotation+=e.angularVelocity*t+.5*e.angularAcceleration*t**2,e.velocity.x+=e.drag*e.acceleration.x*t,e.velocity.y+=e.drag*e.acceleration.y*t;const o=Math.sqrt(e.velocity.x**2+e.velocity.y**2);o>e.maxVelocity&&(e.velocity.x/=o/e.maxVelocity,e.velocity.y/=o/e.maxVelocity),e.angularVelocity+=e.angularAcceleration*t,e.acceleration.x=e.force.x/e.mass,e.acceleration.y=e.force.y/e.mass,e.angularAcceleration=e.torque/e.inertia,e.force.x=0,e.force.y=0,e.torque=0},ke=(e,t)=>Math.sqrt((t.position.x-e.position.x)**2+(t.position.y-e.position.y)**2),le=(e,t)=>ke(e,t)<e.radius+t.radius,Q=(e,t,o,a)=>{if(e.frozen||t.frozen)return!1;const s=ke(e,t);if(s>=e.radius+t.radius)return!1;const r={x:(t.position.x-e.position.x)/s,y:(t.position.y-e.position.y)/s},c=2*(e.velocity.x*r.x+e.velocity.y*r.y-t.velocity.x*r.x-t.velocity.y*r.y)/(e.mass+t.mass),l=e.radius+t.radius-s;a&&(e.position.x-=r.x*l,e.position.y-=r.y*l,t.position.x+=r.x*l,t.position.y+=r.y*l),e.velocity.x-=c*o*t.mass*r.x,e.velocity.y-=c*o*t.mass*r.y,t.velocity.x+=c*o*e.mass*r.x,t.velocity.y+=c*o*e.mass*r.y;const m={position:{x:(e.position.x+t.position.x)/2,y:(e.position.y+t.position.y)/2}};return T(j,m),setTimeout(()=>M(j,m.id),100),!0},de=10,Et=30,me=(e,t,o,a,s)=>.5*(2*o+(-t+a)*e+(2*t-5*o+4*a-s)*e*e+(-t+3*o-3*a+s)*e*e*e),Ee=(e,t,o,a,s)=>({x:me(e,t.x,o.x,a.x,s.x),y:me(e,t.y,o.y,a.y,s.y)}),Pe=(e,t)=>{const o=Math.max(Math.min(Math.floor(t),e.targets.length-4),0);return Ee(t%1,e.targets[o+0].position,e.targets[o+1].position,e.targets[o+2].position,e.targets[o+3].position)},Le=(e,t)=>Pe(e,Ie(e,t)),Pt=e=>{e.arcLengthTable=[];let t=0,o=e.targets[1].position;for(let c=0;c<(e.targets.length-3)*de;++c){const l=c/de,m=Pe(e,l),I=ne(oe(m,o));t+=I,e.arcLengthTable.push({v:l,totalLength:t}),o=m}const a=e.targets.length-4,s=Ee(1,e.targets[a+0].position,e.targets[a+1].position,e.targets[a+2].position,e.targets[a+3].position),r=ne(oe(s,o));t+=r,e.arcLengthTable.push({v:e.targets.length-3,totalLength:t})},Lt=e=>-(Math.cos(Math.PI*e)-1)/2,Ie=(e,t)=>{let o=e.arcLengthTable[e.arcLengthTable.length-1].v;for(let c=1;c<e.arcLengthTable.length;++c){const l=e.arcLengthTable[c-1],m=e.arcLengthTable[c];if(t<m.totalLength){const I=m.totalLength-l.totalLength;if(I===0){o=m.v;break}const _=(t-l.totalLength)/I;o=l.v*(1-_)+m.v*_;break}}const a=Math.floor(o),s=o-a,r=Lt(s);return a+r},It=(e,t,o)=>{const a=Le(e,t);e.velocity=oe(a,e.position),e.rotation=Math.atan2(e.velocity.y,e.velocity.x),e.position=a;const s=Math.max(Math.min(Math.floor(Ie(e,t)),e.targets.length-3),0);if(s!==e.currentTarget&&(o(e.targets[s+1]),e.currentTarget=s),s>=e.targets.length-3){e.remove=!0;return}},St=e=>{e.pathPoints=[];const t=e.arcLengthTable[e.arcLengthTable.length-1].totalLength;for(let o=0;o<=t;o+=Et)e.pathPoints.push(Le(e,o));e.pathPoints.push(e.targets[e.targets.length-2].position)},k=document.getElementsByTagName("canvas")[0],At=()=>({x:Math.random()*k.width,y:Math.random()*k.height}),Dt=()=>{const e=Math.floor(Math.random()*4),t=90;switch(e){case 0:return{x:Math.random()*k.width,y:-90};case 1:return{x:k.width+t,y:Math.random()*k.height};case 2:return{x:Math.random()*k.width,y:k.height+t};case 3:return{x:-90,y:Math.random()*k.height}}},Bt=e=>(Math.random()*2-1)*e,Vt=()=>{const e=[20,30,40];return e[Math.floor(Math.random()*e.length)]},x={timePlayed:0,asteroidsDestroyed:0,damageDealt:0,bulletsFired:0,bulletsHit:0,rocketsFired:0,distanceTraveled:0},h={...x},d={...x},Rt=()=>{h.timePlayed=Math.max(h.timePlayed,d.timePlayed),h.asteroidsDestroyed=Math.max(h.asteroidsDestroyed,d.asteroidsDestroyed),h.damageDealt=Math.max(h.damageDealt,d.damageDealt),h.bulletsFired=Math.max(h.bulletsFired,d.bulletsFired),h.bulletsHit=Math.max(h.bulletsHit,d.bulletsHit),h.rocketsFired=Math.max(h.rocketsFired,d.rocketsFired),h.distanceTraveled=Math.max(h.distanceTraveled,d.distanceTraveled),d.timePlayed=x.timePlayed,d.asteroidsDestroyed=x.asteroidsDestroyed,d.damageDealt=x.damageDealt,d.bulletsFired=x.bulletsFired,d.bulletsHit=x.bulletsHit,d.rocketsFired=x.rocketsFired,d.distanceTraveled=x.distanceTraveled},Ut="/asteroid-pew-pew/audio/propulsion.mp3",Ft="/asteroid-pew-pew/audio/bonk.mp3",_t="/asteroid-pew-pew/audio/explosion.mp3",Ot="/asteroid-pew-pew/audio/laser.mp3",Ct="/asteroid-pew-pew/audio/metal-hit.mp3";let F=.5;const Ht=e=>{F=e},K=new Audio(Ut);K.volume=0;K.loop=!0;document.addEventListener("keydown",()=>K.play().catch(()=>{}),{once:!0});const se=e=>{K.volume=e*F},Nt=()=>{const e=new Audio(Ft);e.volume=.1*F,e.play().catch(()=>{})},Wt=()=>{const e=new Audio(Ct);e.volume=.1*F,e.play().catch(()=>{})},qt=()=>{const e=new Audio(Ot);e.volume=.3*F,e.play().catch(()=>{})},Z=()=>{const e=new Audio(_t);e.volume=.1*F,e.play().catch(()=>{})},$t="/asteroid-pew-pew/img/Asteroid1.png",jt="/asteroid-pew-pew/img/Spaceship.png",Gt="/asteroid-pew-pew/img/WingLeft.png",zt="/asteroid-pew-pew/img/WingRight.png",Se=2e3,Kt=3,Yt=e=>4/3*Math.PI*e**3*3.5;let L=!1,p=document.getElementsByTagName("canvas")[0],Xt=document.getElementById("entity-count"),Jt=document.getElementById("fps"),Qt=document.getElementById("ups"),Zt=document.getElementById("target-fps"),eo=document.getElementById("target-ups"),Ae=document.getElementById("menu"),De=document.getElementById("pause-resume"),to=document.getElementById("debug-velocity"),oo=document.getElementById("debug-hitbox"),so=document.getElementById("debug-trajectory"),ao=document.getElementById("debug-spline-paths"),ro=document.getElementById("debug-rocket-speed"),io=document.getElementById("fire-rate"),Be=document.getElementById("hp"),Ve=document.getElementById("game-over"),no=document.getElementById("time-played"),co=document.getElementById("asteroids-destroyed"),lo=document.getElementById("distance-traveled"),mo=document.getElementById("damage-dealt"),ho=document.getElementById("restart"),go=document.getElementById("volume"),$=1e3/120,Re=1e3/60,G=0,he=0,ae=0,ee=0,te=0,f=[],D=[],B=[],n=null,re=!1,ge=0,Ue=40,ie=!1,uo=3e3,ue=0,Fe=300,A=1e3,pe=0,u={forward:!1,backward:!1,left:!1,right:!1};const po=()=>{G=performance.now(),ae=G,fo(),yo(),_e(),requestAnimationFrame(Oe)},_e=()=>{p.width=p.clientWidth,p.height=p.clientHeight,ko({x:p.width/2,y:p.height/2},0,{x:0,y:0},0)};let fe=0,y=performance.now();const fo=()=>{document.addEventListener("keydown",e=>{switch(e.key){case"Escape":we();break;case" ":re=!0;break;case"q":ie=!0;break;case"ArrowUp":case"w":u.forward=!0;break;case"ArrowDown":case"s":u.backward=!0;break;case"ArrowLeft":case"a":u.left=!0;break;case"ArrowRight":case"d":u.right=!0;break}}),document.addEventListener("keyup",e=>{switch(e.key){case" ":re=!1;break;case"q":ie=!1;break;case"ArrowUp":case"w":u.forward=!1;break;case"ArrowDown":case"s":u.backward=!1;break;case"ArrowLeft":case"a":u.left=!1;break;case"ArrowRight":case"d":u.right=!1;break}}),document.addEventListener("mousemove",e=>{const t=e.clientX-p.getBoundingClientRect().left,o=e.clientY-p.getBoundingClientRect().top;if(n){const a=t-n.position.x,s=o-n.position.y;n.rotation=Math.atan2(s,a)}}),Zt.addEventListener("change",e=>{e.target.value=Math.max(0,Math.min(1e3,Number(e.target.value))),Re=1e3/e.target.value}),eo.addEventListener("change",e=>{e.target.value=Math.max(0,Math.min(1e3,Number(e.target.value))),$=1e3/e.target.value}),to.addEventListener("change",e=>mt(e.target.checked)),oo.addEventListener("change",e=>ht(e.target.checked)),so.addEventListener("change",e=>gt(e.target.checked)),ao.addEventListener("change",e=>ut(e.target.checked)),ro.addEventListener("change",e=>{e.target.value=Math.max(0,Math.min(1e3,Number(e.target.value))),Fe=e.target.value}),De.addEventListener("click",we),ho.addEventListener("click",Lo),go.addEventListener("input",e=>Ht(e.target.value/100))},yo=()=>{io.innerText=`${Math.round(1e3/Ue)}`},Oe=()=>{for(y=performance.now();he+$/2<=y;)L||(wo($),++ee),he+=$;G+Re/2<=y&&(L||(yt(),++te),G=y),y-ae>=1e3&&(Xt.innerText=`${f.length+D.length+B.length+(n?1:0)}`,Jt.innerText=`${te}`,Qt.innerText=`${ee}`,te=0,ee=0,ae=y),requestAnimationFrame(Oe)},xo=e=>{if(re&&y-ge>=Ue&&n){const t=n.rotation+(Math.random()-.5)*.1,o=fe%2===0?-1:1,a=X(n.rotation+Math.PI/2*o);a.x*=10,a.y*=10,a.x+=n.position.x,a.y+=n.position.y,Mo(a,t,X(t),0),qt(),fe++,ge=y}if(ie&&y-ue>=uo&&n){const t=[{position:{x:n.position.x-Math.cos(n.rotation)*100,y:n.position.y-Math.sin(n.rotation)*100}},{position:{x:n.position.x,y:n.position.y}}];for(let o=0;o<Math.min(Kt,f.length);o++){let a;do a=f[Math.floor(Math.random()*f.length)];while(t.includes(a));a.frozen=!0,a.velocity.x=0,a.velocity.y=0,t.push(a)}t.push(n),To({...n.position},n.rotation,He(X(n.rotation),.2),0,t),ue=y}if(y-pe>=A){const t=Dt(),o=At(),a=Math.random()*Math.PI*2,s={x:o.x-t.x,y:o.y-t.y},r=Math.sqrt(s.x**2+s.y**2);r>0&&(s.x/=r,s.y/=r),s.x*=Math.random()*.1+.1,s.y*=Math.random()*.1+.1;const c=Bt(.01),l=Vt();bo(t,a,{x:0,y:0},s,c,l),pe=y,A*=(Math.random()-.6)*.2+1,A=Math.max(A,300),A=Math.min(A,2e3)}n&&(u.forward&&(n.force.y-=.004),u.backward&&(n.force.y+=.004),u.left&&(n.force.x-=.004),u.right&&(n.force.x+=.004))},ye=e=>e.x<-100||e.x>p.width+100||e.y<-100||e.y>p.height+100,wo=e=>{xo(),d.timePlayed+=e;for(const s of f){J(s,e),ye(s.position)&&(s.remove=!0);for(const r of f)s!==r&&Q(s,r,1,!0)&&Nt()}for(const s of D){J(s,e),ye(s.position)&&(s.remove=!0);for(const r of f)Q(s,r,1,!1)&&(s.remove=!0,r.hp-=1,d.bulletsHit++,d.damageDealt++,r.hp<=0&&(++d.asteroidsDestroyed,r.remove=!0,Z()))}for(const s of B)s.progress+=e/1e3*Fe,It(s,s.progress,r=>{r.remove=!0,++d.asteroidsDestroyed,d.damageDealt+=(r==null?void 0:r.hp)??0,Z()});const t={...n.position};J(n,e);const o={x:n.position.x-t.x,y:n.position.y-t.y},a=Math.sqrt(o.x**2+o.y**2);d.distanceTraveled+=a,se(Math.min(a/100,.05));for(const s of f)if(Q(n,s,1,!0)&&(n.hp-=1,Wt(),n.hp>=0&&(Be.children.item(n.hp).style.color="grey"),n.hp<=0)){Z(),Eo(),n.frame=0,se(0),T(H,n),setTimeout(()=>{Po()},1e3);break}!u.forward&&!u.backward&&!u.left&&!u.right&&(n.velocity.x*=Math.pow(.25,e/1e3),n.velocity.y*=Math.pow(.25,e/1e3)),(n.position.x<0||n.position.x>p.width)&&(n.position.x=Math.max(0,Math.min(n.position.x,p.width)),n.velocity.x*=-1),(n.position.y<0||n.position.y>p.height)&&(n.position.y=Math.max(0,Math.min(n.position.y,p.height)),n.velocity.y*=-1),vo()},vo=()=>{f.forEach(e=>{e.remove&&(M(C,e.id),e.frame=0,T(H,e))}),D.forEach(e=>{e.remove&&M(w,e.id)}),B.forEach(e=>{e.remove&&(M(v,e.id),e.children.forEach(t=>{M(R,t.id)}))}),f=f.filter(e=>!e.remove),D=D.filter(e=>!e.remove),B=B.filter(e=>!e.remove)},bo=(e,t,o,a,s,r)=>{const c=U();c.position=e,c.rotation=t,c.acceleration=o,c.velocity=a,c.angularVelocity=s,c.mass=Yt(r),c.radius=r,c.inertia=2/5*c.mass*r**2,c.hp=r/2;const l=new Image;if(l.src=$t,c.texture=l,!le(c,n)){for(const m of f)if(le(c,m))return;T(C,c),f.push(c)}},Mo=(e,t,o,a)=>{const s=U();s.position=e,s.rotation=t,s.velocity=o,s.angularVelocity=a,s.mass=Se,s.radius=5,s.inertia=2/5*s.mass*s.radius**2,T(w,s),D.push(s),++d.bulletsFired},To=(e,t,o,a,s)=>{const r=U();r.position=e,r.rotation=t,r.velocity=o,r.angularVelocity=a,r.mass=Se,r.radius=5,r.targets=s,r.progress=0,r.currentTarget=0,Pt(r),St(r),T(v,r),B.push(r),Ce({x:-5,y:0},Math.PI/2,r),++d.rocketsFired},ko=(e,t,o,a)=>{n=U(),n.position=e,n.rotation=t,n.velocity=o,n.angularVelocity=a,n.mass=10,n.drag=1,n.maxVelocity=.5,n.height=40,n.width=40,n.radius=n.width/2,n.hp=5;const s=new Image;s.src=jt,n.texture=s,T(N,n),xe({x:-5,y:18},0,V,zt,n),xe({x:-5,y:-18},0,V,Gt,n)},xe=(e,t,o,a,s)=>{const r=U();r.position=e,r.rotation=t,r.parent=s,r.height=20,r.width=20,T(o,r);const c=new Image;c.src=a,r.texture=c,s.children??(s.children=s.children||[]),s.children.push(r),Ce({x:-5,y:0},1.5707964,r)},Ce=(e,t,o)=>{const a=U();a.position=e,a.rotation=t,a.parent=o,a.height=10,a.width=5,o.children??(o.children=o.children||[]),o.children.push(a),T(R,a)},we=()=>{L=!L,De.innerText=L?"Resume":"Pause",Ae.style.display=L?"flex":"none"},Eo=()=>{if(n){M(N,n.id);for(let e of n.children){M(V,e.id);for(let t of e.children)M(R,t.id)}}},Po=()=>{L=!0,se(0),W(no,(d.timePlayed/1e3).toFixed(1),(h.timePlayed/1e3).toFixed(1),"s"),W(co,d.asteroidsDestroyed,h.asteroidsDestroyed),W(lo,d.distanceTraveled.toFixed(1),h.distanceTraveled.toFixed(1),"m"),W(mo,d.damageDealt,h.damageDealt,"hp"),Ve.style.display="grid"},W=(e,t,o,a)=>{e.children.item(1).innerText=a?`${t} ${a}`:`${t}`,e.children.item(2).classList.remove("new-best"),e.children.item(2).classList.remove("previous-best"),t>o?(e.children.item(2).classList.add("new-best"),e.children.item(2).innerText="New best!"):(e.children.item(2).classList.add("previous-best"),e.children.item(2).innerText=`( Best: ${a?`${o} ${a}`:o} )`)},Lo=()=>{Rt(),pt(),f=[],D=[],B=[],A=1e3;for(let e of Be.children)e.style.color="red";Ve.style.display="none",Ae.style.display="none",_e(),L=!1};po();
