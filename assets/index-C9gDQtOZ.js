(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();const se=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),qe=(e,t)=>{e.x*=t,e.y*=t},X=e=>({x:Math.cos(e),y:Math.sin(e)}),ce=e=>Math.sqrt(e.x**2+e.y**2);let E=new Map;const $e=2e3,N=e=>{const t={x:e.position.x,y:e.position.y,rotation:e.rotation},o=e.parent;if(o==null)return t;const a=N(o),s=Math.cos(a.rotation),r=Math.sin(a.rotation);return{x:a.x+t.x*s-t.y*r,y:a.y+t.x*r+t.y*s,rotation:a.rotation+t.rotation}},je=(e,t)=>{E[e]||(E[e]=[]);const o=performance.now();E[e].push({x:t.x,y:t.y,time:o}),E[e]=E[e].filter(a=>o-a.time<$e)},Ge=e=>{delete E[e]},ze=e=>{for(const t in E){const o=E[t];if(!(!o||o.length<2)){e.beginPath();for(let a=0;a<o.length;a++){const s=o[a];a===0?e.moveTo(s.x,s.y):e.lineTo(s.x,s.y)}e.strokeStyle="rgba(255, 255, 255, 0.5)",e.lineWidth=1,e.stroke()}}},Je="/asteroid-pew-pew/img/boom/boom_0.gif",Ke="/asteroid-pew-pew/img/boom/boom_1.gif",Ye="/asteroid-pew-pew/img/boom/boom_2.gif",Xe="/asteroid-pew-pew/img/boom/boom_3.gif",Qe="/asteroid-pew-pew/img/boom/boom_4.gif",Ze="/asteroid-pew-pew/img/boom/boom_5.gif",et="/asteroid-pew-pew/img/boom/boom_6.gif",tt="/asteroid-pew-pew/img/boom/boom_7.gif",ot="/asteroid-pew-pew/img/boom/boom_8.gif",st="/asteroid-pew-pew/img/boom/boom_9.gif",at="/asteroid-pew-pew/img/boom/boom_10.gif",rt="/asteroid-pew-pew/img/boom/boom_11.gif",nt="/asteroid-pew-pew/img/boom/boom_12.gif",it="/asteroid-pew-pew/img/boom/boom_13.gif",ct="/asteroid-pew-pew/img/boom/boom_14.gif",S=document.getElementsByTagName("canvas")[0],n=S.getContext("2d"),C="asteroid",x="bullet",H="explosion",G="flash",w="rocket",W="spaceship",be="velocity",R="spaceshippart",U="flames",lt="#ffffff",dt="#ffff00",$="#ff0000",le="#00ff00";let mt=0;const ht=()=>`${mt++}`,v={[C]:{color:lt},[x]:{color:dt,length:10,strokeWidth:2},[w]:{color:$,radius:10},[W]:{color:le},[be]:{color:$},[R]:{color:le},[U]:{color:$}},P={[U]:{},[W]:{},[R]:{},[C]:{},[x]:{},[w]:{},[H]:{},[G]:{}};let Me=!1,J=!1,Te=!1,Ee=!1;const gt=e=>{Me=e},ut=e=>{J=e},pt=e=>{Te=e},ft=e=>{Ee=e},M=(e,t)=>{t.id=ht(),P[e][t.id]=t},b=(e,t)=>{delete P[e][t],Ge(t)},yt=()=>{for(const e in P)P[e]={}},h=[];for(let e=0;e<15;++e)h.push(new Image);h[0].src=Je;h[1].src=Ke;h[2].src=Ye;h[3].src=Xe;h[4].src=Qe;h[5].src=Ze;h[6].src=et;h[7].src=tt;h[8].src=ot;h[9].src=st;h[10].src=at;h[11].src=rt;h[12].src=nt;h[13].src=it;h[14].src=ct;const xt=()=>{S.width=S.clientWidth,S.height=S.clientHeight,n.clearRect(0,0,S.width,S.height);for(const e in P)for(const t of Object.values(P[e])){switch(e){case C:wt(t);break;case H:Mt(t);break;case x:vt(t);break;case w:bt(t);break;case W:case R:Tt(t);break;case U:Et(t);break;case G:kt(t);break}je(t.id,N(t))}if(Me){n.strokeStyle=v[be].color,n.lineWidth=1,n.beginPath();for(const e in P){for(const t of Object.values(P[e]))if("velocity"in t){const{position:o,velocity:a}=t,{x:s,y:r}=o,{x:c,y:l}=a;n.moveTo(s,r),n.lineTo(s+c*200,r+l*200)}n.stroke()}}Te&&ze(n)},wt=e=>{const{radius:t,texture:o}=e,a=N(e);n.save(),n.translate(a.x,a.y),n.rotate(a.rotation),n.drawImage(o,-t,-t,t*2,t*2),J&&(n.strokeStyle=$,n.lineWidth=1,n.beginPath(),n.moveTo(0,0),n.arc(0,0,t,0,2*Math.PI),n.stroke()),n.restore()},vt=e=>{var s;const{length:t}=v[x],o=Math.cos(e.rotation)*t/2,a=Math.sin(e.rotation)*t/2;n.fillStyle=v[x].color,n.strokeStyle=v[x].color,n.lineWidth=(s=v[x])==null?void 0:s.strokeWidth,n.beginPath(),n.moveTo(e.position.x+o,e.position.y+a),n.lineTo(e.position.x-o,e.position.y-a),n.stroke()},bt=e=>{var c;const{radius:t}=v[w],o=2*Math.PI/8,a={x:e.position.x+t*Math.cos(e.rotation),y:e.position.y+t*Math.sin(e.rotation)},s={x:e.position.x-t*Math.cos(e.rotation+o),y:e.position.y-t*Math.sin(e.rotation+o)},r={x:e.position.x-t*Math.cos(e.rotation-o),y:e.position.y-t*Math.sin(e.rotation-o)};if(n.fillStyle=v[w].color,n.strokeStyle=v[w].color,n.lineWidth=((c=v[w])==null?void 0:c.strokeWidth)??0,n.beginPath(),n.moveTo(a.x,a.y),n.lineTo(s.x,s.y),n.lineTo(r.x,r.y),n.lineTo(a.x,a.y),n.stroke(),Ee){n.strokeStyle="grey",n.beginPath(),n.moveTo(e.pathPoints[0].x,e.pathPoints[0].y);for(const l of e.pathPoints)n.lineTo(l.x,l.y),n.arc(l.x,l.y,2,0,2*Math.PI),n.moveTo(l.x,l.y);n.lineTo(e.targets[e.targets.length-1].x,e.targets[e.targets.length-1].y),n.stroke()}},Mt=e=>{n.translate(e.position.x,e.position.y);const a=h[e.frame];n.drawImage(a,-100/2,-100/2,100,100),n.translate(-e.position.x,-e.position.y),e.frame<h.length-1?e.frame++:b(H,e.id)},Tt=e=>{const{width:t,height:o,texture:a}=e,s=N(e);n.save(),n.translate(s.x,s.y),n.rotate(s.rotation),n.drawImage(a,-t/2,-o/2,t,o),J&&(n.strokeStyle="lime",n.lineWidth=1,n.strokeRect(-t/2,-o/2,t,o)),n.restore()},Et=e=>{var I,Y,O;const{width:t,height:o}=e,a=N(e),s=((I=e==null?void 0:e.parent)==null?void 0:I.velocity)??{x:0,y:1},r=((O=(Y=e==null?void 0:e.parent)==null?void 0:Y.parent)==null?void 0:O.velocity)??{x:0,y:0},c={x:s.x+r.x,y:s.y+r.y},l=Math.min(Math.sqrt(c.x**2+c.y**2)*5,2);n.save(),n.translate(a.x,a.y),n.rotate(a.rotation),n.beginPath();const m=Math.random()*5;n.moveTo(0,0),n.lineTo(-t,(o+m)*l),n.lineTo(t,(o+m)*l),n.closePath(),n.fillStyle="orange",n.fill(),n.beginPath(),n.moveTo(0,0),n.lineTo(-t/2,(o/2+m)*l),n.lineTo(t/2,(o/2+m)*l),n.closePath(),n.fillStyle="yellow",n.fill(),J&&(n.strokeStyle="lime",n.lineWidth=1,n.strokeRect(-t,0,t*2,o+m)),n.restore()},kt=e=>{const t=e.position,o=3,a=15;n.fillStyle="white",n.beginPath(),n.moveTo(t.x+o,t.y+o),n.lineTo(t.x+a,t.y),n.lineTo(t.x+o,t.y-o),n.lineTo(t.x,t.y-a),n.lineTo(t.x-o,t.y-o),n.lineTo(t.x-a,t.y),n.lineTo(t.x-o,t.y+o),n.lineTo(t.x,t.y+a),n.closePath(),n.fill()},F=()=>({position:{x:0,y:0},velocity:{x:0,y:0},acceleration:{x:0,y:0},force:{x:0,y:0},rotation:0,angularVelocity:0,angularAcceleration:0,torque:0,mass:1,inertia:1,radius:0,drag:1,height:0,width:0,maxVelocity:1,parent:null,texture:null}),Q=(e,t)=>{if(e.frozen)return;e.position.x+=e.velocity.x*t+.5*e.acceleration.x*t**2,e.position.y+=e.velocity.y*t+.5*e.acceleration.y*t**2,e.rotation+=e.angularVelocity*t+.5*e.angularAcceleration*t**2,e.velocity.x+=e.drag*e.acceleration.x*t,e.velocity.y+=e.drag*e.acceleration.y*t;const o=Math.sqrt(e.velocity.x**2+e.velocity.y**2);o>e.maxVelocity&&(e.velocity.x/=o/e.maxVelocity,e.velocity.y/=o/e.maxVelocity),e.angularVelocity+=e.angularAcceleration*t,e.acceleration.x=e.force.x/e.mass,e.acceleration.y=e.force.y/e.mass,e.angularAcceleration=e.torque/e.inertia,e.force.x=0,e.force.y=0,e.torque=0},ke=(e,t)=>Math.sqrt((t.position.x-e.position.x)**2+(t.position.y-e.position.y)**2),de=(e,t)=>ke(e,t)<e.radius+t.radius,Z=(e,t,o,a)=>{if(e.frozen||t.frozen)return!1;const s=ke(e,t);if(s>=e.radius+t.radius)return!1;const r={x:(t.position.x-e.position.x)/s,y:(t.position.y-e.position.y)/s},c=2*(e.velocity.x*r.x+e.velocity.y*r.y-t.velocity.x*r.x-t.velocity.y*r.y)/(e.mass+t.mass),l=e.radius+t.radius-s;a&&(e.position.x-=r.x*l,e.position.y-=r.y*l,t.position.x+=r.x*l,t.position.y+=r.y*l),e.velocity.x-=c*o*t.mass*r.x,e.velocity.y-=c*o*t.mass*r.y,t.velocity.x+=c*o*e.mass*r.x,t.velocity.y+=c*o*e.mass*r.y;const m={position:{x:(e.position.x+t.position.x)/2,y:(e.position.y+t.position.y)/2}};return M(G,m),setTimeout(()=>b(G,m.id),100),!0},me=10,Pt=30,he=(e,t,o,a,s)=>.5*(2*o+(-t+a)*e+(2*t-5*o+4*a-s)*e*e+(-t+3*o-3*a+s)*e*e*e),Pe=(e,t,o,a,s)=>({x:he(e,t.x,o.x,a.x,s.x),y:he(e,t.y,o.y,a.y,s.y)}),Le=(e,t)=>{const o=Math.max(Math.min(Math.floor(t),e.targets.length-4),0);return Pe(t%1,e.targets[o+0].position,e.targets[o+1].position,e.targets[o+2].position,e.targets[o+3].position)},Ie=(e,t)=>Le(e,Se(e,t)),Lt=e=>{e.arcLengthTable=[];let t=0,o=e.targets[1].position;for(let c=0;c<(e.targets.length-3)*me;++c){const l=c/me,m=Le(e,l),I=ce(se(m,o));t+=I,e.arcLengthTable.push({v:l,totalLength:t}),o=m}const a=e.targets.length-4,s=Pe(1,e.targets[a+0].position,e.targets[a+1].position,e.targets[a+2].position,e.targets[a+3].position),r=ce(se(s,o));t+=r,e.arcLengthTable.push({v:e.targets.length-3,totalLength:t})},It=e=>-(Math.cos(Math.PI*e)-1)/2,Se=(e,t)=>{let o=e.arcLengthTable[e.arcLengthTable.length-1].v;for(let c=1;c<e.arcLengthTable.length;++c){const l=e.arcLengthTable[c-1],m=e.arcLengthTable[c];if(t<m.totalLength){const I=m.totalLength-l.totalLength;if(I===0){o=m.v;break}const O=(t-l.totalLength)/I;o=l.v*(1-O)+m.v*O;break}}const a=Math.floor(o),s=o-a,r=It(s);return a+r},St=(e,t,o)=>{const a=Ie(e,t);e.velocity=se(a,e.position),e.rotation=Math.atan2(e.velocity.y,e.velocity.x),e.position=a;const s=Math.max(Math.min(Math.floor(Se(e,t)),e.targets.length-3),0);if(s!==e.currentTarget&&(o(e.targets[s+1]),e.currentTarget=s),s>=e.targets.length-3){e.remove=!0;return}},Bt=e=>{e.pathPoints=[];const t=e.arcLengthTable[e.arcLengthTable.length-1].totalLength;for(let o=0;o<=t;o+=Pt)e.pathPoints.push(Ie(e,o));e.pathPoints.push(e.targets[e.targets.length-2].position)},T=document.getElementsByTagName("canvas")[0],At=()=>({x:Math.random()*T.width,y:Math.random()*T.height}),Vt=()=>{const e=Math.floor(Math.random()*4),t=90;switch(e){case 0:return{x:Math.random()*T.width,y:-90};case 1:return{x:T.width+t,y:Math.random()*T.height};case 2:return{x:Math.random()*T.width,y:T.height+t};case 3:return{x:-90,y:Math.random()*T.height}}},Dt=e=>(Math.random()*2-1)*e,Rt=()=>{const e=[20,30,40];return e[Math.floor(Math.random()*e.length)]},y={timePlayed:0,asteroidsDestroyed:0,damageDealt:0,bulletsFired:0,bulletsHit:0,rocketsFired:0,distanceTraveled:0},Ut=JSON.stringify(y),Be=(e,t)=>"best"+(e?"-pacifist":"-default")+(t?"-stationary":"-default"),Ae=(e,t)=>{const o=Be(e,t);return JSON.parse(localStorage.getItem(o)||Ut)},d={...y},Ft=(e,t)=>{const o=Ae(e,t);o.timePlayed=Math.max(o.timePlayed,d.timePlayed),o.asteroidsDestroyed=Math.max(o.asteroidsDestroyed,d.asteroidsDestroyed),o.damageDealt=Math.max(o.damageDealt,d.damageDealt),o.bulletsFired=Math.max(o.bulletsFired,d.bulletsFired),o.bulletsHit=Math.max(o.bulletsHit,d.bulletsHit),o.rocketsFired=Math.max(o.rocketsFired,d.rocketsFired),o.distanceTraveled=Math.max(o.distanceTraveled,d.distanceTraveled),localStorage.setItem(Be(e,t),JSON.stringify(o))},_t=()=>{d.timePlayed=y.timePlayed,d.asteroidsDestroyed=y.asteroidsDestroyed,d.damageDealt=y.damageDealt,d.bulletsFired=y.bulletsFired,d.bulletsHit=y.bulletsHit,d.rocketsFired=y.rocketsFired,d.distanceTraveled=y.distanceTraveled},Ot="/asteroid-pew-pew/audio/propulsion.mp3",Nt="/asteroid-pew-pew/audio/bonk.mp3",Ct="/asteroid-pew-pew/audio/explosion.mp3",Ht="/asteroid-pew-pew/audio/laser.mp3",Wt="/asteroid-pew-pew/audio/metal-hit.mp3";let _=.5;const qt=e=>{_=e},K=new Audio(Ot);K.volume=0;K.loop=!0;document.addEventListener("keydown",()=>K.play().catch(()=>{}),{once:!0});const ae=e=>{K.volume=e*_},$t=()=>{const e=new Audio(Nt);e.volume=.1*_,e.play().catch(()=>{})},jt=()=>{const e=new Audio(Wt);e.volume=.1*_,e.play().catch(()=>{})},Gt=()=>{const e=new Audio(Ht);e.volume=.3*_,e.play().catch(()=>{})},ee=()=>{const e=new Audio(Ct);e.volume=.1*_,e.play().catch(()=>{})},zt="/asteroid-pew-pew/img/Asteroid1.png",Jt="/asteroid-pew-pew/img/Spaceship.png",Kt="/asteroid-pew-pew/img/WingLeft.png",Yt="/asteroid-pew-pew/img/WingRight.png",Ve=2e3,Xt=3,Qt=e=>4/3*Math.PI*e**3*3.5;let L=!1,u=document.getElementsByTagName("canvas")[0],Zt=document.getElementById("entity-count"),eo=document.getElementById("fps"),to=document.getElementById("ups"),oo=document.getElementById("target-fps"),so=document.getElementById("target-ups"),De=document.getElementById("pause-menu"),ao=document.getElementById("main-menu"),Re=document.getElementById("pause-resume"),ro=document.getElementById("debug-velocity"),no=document.getElementById("debug-hitbox"),io=document.getElementById("debug-trajectory"),co=document.getElementById("debug-spline-paths"),lo=document.getElementById("debug-rocket-speed"),mo=document.getElementById("fire-rate"),Ue=document.getElementById("hp"),Fe=document.getElementById("game-over"),ho=document.getElementById("time-played"),go=document.getElementById("asteroids-destroyed"),uo=document.getElementById("distance-traveled"),po=document.getElementById("damage-dealt"),fo=document.getElementById("start"),yo=document.getElementById("restart"),xo=document.getElementById("volume"),wo=document.getElementById("mode-pacifist"),vo=document.getElementById("mode-stationary"),bo=document.getElementById("mark-pacifist"),Mo=document.getElementById("mark-stationary"),j=1e3/120,_e=1e3/60,z=0,ge=0,re=0,te=0,oe=0,D=!0,k=!0,p=[],A=[],V=[],i=null,ne=!1,ue=0,Oe=40,ie=!1,To=3e3,pe=0,Ne=300,B=1e3,fe=0,g={forward:!1,backward:!1,left:!1,right:!1};const Eo=()=>{z=performance.now(),re=z,ko(),Po()},Ce=()=>{u.width=u.clientWidth,u.height=u.clientHeight,Do({x:u.width/2,y:u.height/2},0,{x:0,y:0},0)};let ye=0,f=performance.now();const ko=()=>{document.addEventListener("keydown",e=>{switch(e.key){case"Escape":ve();break;case" ":ne=D;break;case"q":ie=D;break;case"ArrowUp":case"w":g.forward=k;break;case"ArrowDown":case"s":g.backward=k;break;case"ArrowLeft":case"a":g.left=k;break;case"ArrowRight":case"d":g.right=k;break}}),document.addEventListener("keyup",e=>{switch(e.key){case" ":ne=!1;break;case"q":ie=!1;break;case"ArrowUp":case"w":g.forward=!1;break;case"ArrowDown":case"s":g.backward=!1;break;case"ArrowLeft":case"a":g.left=!1;break;case"ArrowRight":case"d":g.right=!1;break}}),document.addEventListener("mousemove",e=>{const t=e.clientX-u.getBoundingClientRect().left,o=e.clientY-u.getBoundingClientRect().top;if(i){const a=t-i.position.x,s=o-i.position.y;i.rotation=Math.atan2(s,a)}}),oo.addEventListener("change",e=>{e.target.value=Math.max(0,Math.min(1e3,Number(e.target.value))),_e=1e3/e.target.value}),so.addEventListener("change",e=>{e.target.value=Math.max(0,Math.min(1e3,Number(e.target.value))),j=1e3/e.target.value}),ro.addEventListener("change",e=>gt(e.target.checked)),no.addEventListener("change",e=>ut(e.target.checked)),io.addEventListener("change",e=>pt(e.target.checked)),co.addEventListener("change",e=>ft(e.target.checked)),lo.addEventListener("change",e=>{e.target.value=Math.max(0,Math.min(1e3,Number(e.target.value))),Ne=e.target.value}),Re.addEventListener("click",ve),fo.addEventListener("click",()=>{ao.style.display="none",Ce(),requestAnimationFrame(He)}),yo.addEventListener("click",Fo),xo.addEventListener("input",e=>qt(e.target.value/100)),wo.addEventListener("change",e=>{D=!e.target.checked}),vo.addEventListener("change",e=>{k=!e.target.checked})},Po=()=>{mo.innerText=`${Math.round(1e3/Oe)}`},He=()=>{for(f=performance.now();ge+j/2<=f;)L||(Io(j),++te),ge+=j;z+_e/2<=f&&(L||(xt(),++oe),z=f),f-re>=1e3&&(Zt.innerText=`${p.length+A.length+V.length+(i?1:0)}`,eo.innerText=`${oe}`,to.innerText=`${te}`,oe=0,te=0,re=f),requestAnimationFrame(He)},Lo=e=>{if(ne&&f-ue>=Oe&&i){const t=i.rotation+(Math.random()-.5)*.1,o=ye%2===0?-1:1,a=X(i.rotation+Math.PI/2*o);a.x*=10,a.y*=10,a.x+=i.position.x,a.y+=i.position.y,Ao(a,t,X(t),0),Gt(),ye++,ue=f}if(ie&&f-pe>=To&&i){const t=[{position:{x:i.position.x-Math.cos(i.rotation)*100,y:i.position.y-Math.sin(i.rotation)*100}},{position:{x:i.position.x,y:i.position.y}}];for(let o=0;o<Math.min(Xt,p.length);o++){let a;do a=p[Math.floor(Math.random()*p.length)];while(t.includes(a));a.frozen=!0,a.velocity.x=0,a.velocity.y=0,t.push(a)}t.push(i),Vo({...i.position},i.rotation,qe(X(i.rotation),.2),0,t),pe=f}if(f-fe>=B){const t=Vt(),o=At(),a=Math.random()*Math.PI*2,s={x:o.x-t.x,y:o.y-t.y},r=Math.sqrt(s.x**2+s.y**2);r>0&&(s.x/=r,s.y/=r),s.x*=Math.random()*.1+.1,s.y*=Math.random()*.1+.1;const c=Dt(.01),l=Rt();Bo(t,a,{x:0,y:0},s,c,l),fe=f,B*=(Math.random()-.6)*.2+1,B=Math.max(B,300),B=Math.min(B,2e3)}i&&(g.forward&&(i.force.y-=.004),g.backward&&(i.force.y+=.004),g.left&&(i.force.x-=.004),g.right&&(i.force.x+=.004))},xe=e=>e.x<-100||e.x>u.width+100||e.y<-100||e.y>u.height+100,Io=e=>{Lo(),d.timePlayed+=e;for(const s of p){Q(s,e),xe(s.position)&&(s.remove=!0);for(const r of p)s!==r&&Z(s,r,1,!0)&&$t()}for(const s of A){Q(s,e),xe(s.position)&&(s.remove=!0);for(const r of p)Z(s,r,1,!1)&&(s.remove=!0,r.hp-=1,d.bulletsHit++,d.damageDealt++,r.hp<=0&&(++d.asteroidsDestroyed,r.remove=!0,ee()))}for(const s of V)s.progress+=e/1e3*Ne,St(s,s.progress,r=>{r.remove=!0,++d.asteroidsDestroyed,d.damageDealt+=(r==null?void 0:r.hp)??0,ee()});const t={...i.position};Q(i,e);const o={x:i.position.x-t.x,y:i.position.y-t.y},a=Math.sqrt(o.x**2+o.y**2);d.distanceTraveled+=a,ae(Math.min(a/100,.05));for(const s of p)if(Z(i,s,1,!0)&&(i.hp-=1,jt(),i.hp>=0&&(Ue.children.item(i.hp).style.color="grey"),i.hp<=0)){ee(),Ro(),i.frame=0,ae(0),M(H,i),setTimeout(()=>{Uo()},1e3);break}!g.forward&&!g.backward&&!g.left&&!g.right&&(i.velocity.x*=Math.pow(.25,e/1e3),i.velocity.y*=Math.pow(.25,e/1e3)),(i.position.x<0||i.position.x>u.width)&&(i.position.x=Math.max(0,Math.min(i.position.x,u.width)),i.velocity.x*=-1),(i.position.y<0||i.position.y>u.height)&&(i.position.y=Math.max(0,Math.min(i.position.y,u.height)),i.velocity.y*=-1),So()},So=()=>{p.forEach(e=>{e.remove&&(b(C,e.id),e.frame=0,M(H,e))}),A.forEach(e=>{e.remove&&b(x,e.id)}),V.forEach(e=>{e.remove&&(b(w,e.id),e.children.forEach(t=>{b(U,t.id)}))}),p=p.filter(e=>!e.remove),A=A.filter(e=>!e.remove),V=V.filter(e=>!e.remove)},Bo=(e,t,o,a,s,r)=>{const c=F();c.position=e,c.rotation=t,c.acceleration=o,c.velocity=a,c.angularVelocity=s,c.mass=Qt(r),c.radius=r,c.inertia=2/5*c.mass*r**2,c.hp=r/2;const l=new Image;if(l.src=zt,c.texture=l,!de(c,i)){for(const m of p)if(de(c,m))return;M(C,c),p.push(c)}},Ao=(e,t,o,a)=>{const s=F();s.position=e,s.rotation=t,s.velocity=o,s.angularVelocity=a,s.mass=Ve,s.radius=5,s.inertia=2/5*s.mass*s.radius**2,M(x,s),A.push(s),++d.bulletsFired},Vo=(e,t,o,a,s)=>{const r=F();r.position=e,r.rotation=t,r.velocity=o,r.angularVelocity=a,r.mass=Ve,r.radius=5,r.targets=s,r.progress=0,r.currentTarget=0,Lt(r),Bt(r),M(w,r),V.push(r),We({x:-5,y:0},Math.PI/2,r),++d.rocketsFired},Do=(e,t,o,a)=>{i=F(),i.position=e,i.rotation=t,i.velocity=o,i.angularVelocity=a,i.mass=10,i.drag=1,i.maxVelocity=.5,i.height=40,i.width=40,i.radius=i.width/2,i.hp=5;const s=new Image;s.src=Jt,i.texture=s,M(W,i),we({x:-5,y:18},0,R,Yt,i),we({x:-5,y:-18},0,R,Kt,i)},we=(e,t,o,a,s)=>{const r=F();r.position=e,r.rotation=t,r.parent=s,r.height=20,r.width=20,M(o,r);const c=new Image;c.src=a,r.texture=c,s.children??(s.children=s.children||[]),s.children.push(r),We({x:-5,y:0},1.5707964,r)},We=(e,t,o)=>{const a=F();a.position=e,a.rotation=t,a.parent=o,a.height=10,a.width=5,o.children??(o.children=o.children||[]),o.children.push(a),M(U,a)},ve=()=>{L=!L,Re.innerText=L?"Resume":"Pause",De.style.display=L?"flex":"none"},Ro=()=>{if(i){b(W,i.id);for(let e of i.children){b(R,e.id);for(let t of e.children)b(U,t.id)}}},Uo=()=>{L=!0,ae(0);const e=Ae(!D,!k);bo.style.display=D?"none":"block",Mo.style.display=k?"none":"block",q(ho,(d.timePlayed/1e3).toFixed(1),(e.timePlayed/1e3).toFixed(1),"s"),q(go,d.asteroidsDestroyed,e.asteroidsDestroyed),q(uo,d.distanceTraveled.toFixed(1),e.distanceTraveled.toFixed(1),"m"),q(po,d.damageDealt,e.damageDealt,"hp"),Ft(!D,!k),Fe.style.display="grid"},q=(e,t,o,a)=>{e.children.item(1).innerText=a?`${t} ${a}`:`${t}`,e.children.item(2).classList.remove("new-best"),e.children.item(2).classList.remove("previous-best"),t>o?(e.children.item(2).classList.add("new-best"),e.children.item(2).innerText="New best!"):(e.children.item(2).classList.add("previous-best"),e.children.item(2).innerText=`( Best: ${a?`${o} ${a}`:o} )`)},Fo=()=>{_t(),yt(),p=[],A=[],V=[],B=1e3;for(let e of Ue.children)e.style.color="red";Fe.style.display="none",De.style.display="none",Ce(),L=!1};Eo();
